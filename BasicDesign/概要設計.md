# NLB の health check の概要設計

## **概要**
NLBのHealth Checkで運用し、同期のMariaDB の database serviceを実装する。その内に1つのMariaDBがダウンすると、自動的に切り離され、他のMariaDBで実装しています。これは負荷を振り分けることで、1つのサーバの負荷を軽減する仕組みである。



## **特徴**
* NLBはレイヤ4で動作しているので、TCP、UDP、TLSのトラフィック分散
  
* WebSocketで通信を行うアプリケーションで、接続状態を長時間維持する通信処理に対応

* 送信元IPアドレスを管理でき、安定した通信処理を行える

* DSR方式の実現L4ロードバランサーのように動作可能

* 同一ポート番号での処理

## **目的:**&#x20;

* 単一の機能を1つにまとめます。

* 1台が故障や同期異常の場合、自動的に切り離され、他の台で実装しています。

## **利点:**&#x20;

* サーバーが過負荷になってダウンする状況をシステムが最小限に抑えることができます。&#x20;

* 1台が故障すると、負荷分散がそのサーバーのワークロードを残りのサーバーに振り分け、システムのアップタイムを最大限に押し上げ、全体的な性能を向上させます。
* 
## **例:**&#x20;
ユーザーからポート22で、kawanoy1という中継サーバーにアクセスする。中継サーバーでは、

<div style="text-align: center;">
<img src="./Image/AWS-NLB-EX.png" alt="User access to 2 servers (Example)" width="100%"/></div>
